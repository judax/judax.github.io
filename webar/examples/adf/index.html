<html>
<body>

<!-- Error handling -->
<script>
    window.addEventListener('error', function(event) {
        var errorMessage = event.message;
        var url = event.filename;
        var lineNumber = event.lineno;
        var columnNumber = event.colno;
        alert("ERROR: " + errorMessage + " at " + url + " : " + lineNumber + " : " + columnNumber);
    });
</script>

<script>
    if (navigator.getVRDisplays) {
        navigator.getVRDisplays().then(function(vrDisplays) {
            if (vrDisplays && vrDisplays.length > 0) {
                // Only get the last VRDisplay that has support for ADFs and the list of ADFs from it
                var vrDisplay = null;
                var adfs = null;
                for (var i = 0; i < vrDisplays.length; i++) {
                    if (vrDisplays[i].capabilities.hasADFSupport) {
                        vrDisplay = vrDisplays[i];
                    	adfs = vrDisplay.getADFs();
                    	var s = "";
                    	for (var j = 0; j < adfs.length; j++) {
                    		s = "{ uuid = " + adfs[j].uuid + ", name = " + adfs[j].name + ", creationTime = " + adfs[j].creationTime + "}" + (j < adfs.length - 1 ? ", " : "");
                    	}
                    	alert("adfs(" + adfs.length + ")" + (s !== "" ? " = " + s : ""));
                    }
                }
                if (vrDisplay !== null) {
                    var active = false;
                    // Only try to activate/deactivate the first ADF from the list.
                    window.addEventListener("click", function() {
                        if (adfs.length > 0) {
                            if (!active) {
                                vrDisplay.enableADF(adfs[0]);
                            }
                            else {
                                vrDisplay.disableADF();
                            }
                            active = !active;
                        }
                        else {
                            alert("Cannot activate or deactivate ADFs because there were none on the VRDisplay.");
                        }
                    });
                }
                else {
                    alert("There are no VRDisplays that have ADF support.");
                }

            }
            else {
                alert("There are no VRDisplays.");
            }
        });
    }
    else 
    {
        alert("No navigator.getVRDisplays");
    }

</script>
</body>
</html>