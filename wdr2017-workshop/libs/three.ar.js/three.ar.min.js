/*
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("three"));else if("function"==typeof define&&define.amd)define(["three"],t);else{var n=t("object"==typeof exports?require("three"):e.THREE);for(var i in n)("object"==typeof exports?exports:e)[i]=n[i]}}(this,function(e){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=3)}([function(t,n){t.exports=e},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.displayUnsupportedMessage=t.getRandomPaletteColor=t.placeObjectAtHit=t.loadBlocksModel=t.getARDisplay=t.isARDisplay=t.isARKit=t.isTango=void 0;var i=n(0),r=n(6),o=["#F44336","#E91E63","#9C27B0","#673AB7","#3F51B5","#2196F3","#03A9F4","#00BCD4","#009688","#4CAF50","#8BC34A","#CDDC39","#FFEB3B","#FFC107","#FF9800"].map(function(e){return new i.Color(e)}),a=Object.create(null);a.isTango=function(e){return e&&e.displayName.toLowerCase().includes("tango")};var s=t.isTango=a.isTango;a.isARKit=function(e){return e&&e.displayName.toLowerCase().includes("arkit")};var l=t.isARKit=a.isARKit;a.isARDisplay=function(e){return l(e)||s(e)};var u=t.isARDisplay=a.isARDisplay;a.getARDisplay=function(){return new Promise(function(e,t){navigator.getVRDisplays?navigator.getVRDisplays().then(function(t){if(t||0!==t.length){var n=!0,i=!1,r=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if(u(s))return void e(s)}}catch(e){i=!0,r=e}finally{try{!n&&a.return&&a.return()}finally{if(i)throw r}}e(null)}else e(null)}):e(null)})};t.getARDisplay=a.getARDisplay;a.loadBlocksModel=function(t,n){return new Promise(function(o,a){if(e.THREE&&e.THREE.OBJLoader&&e.THREE.MTLLoader){var s=Promise.resolve();n&&(s=(0,r.loadMtl)(n)),s.then(function(e){return e&&e.preload(),(0,r.loadObj)(t,e)}).then(function(e){var t=e.children[0];return t.geometry.applyMatrix((new i.Matrix4).makeRotationY(i.Math.degToRad(-90))),t}).then(o,a)}else a(new Error("Must include THREE.OBJLoader and THREE.MTLLoader"))})};t.loadBlocksModel=a.loadBlocksModel;var c=new i.Matrix4,f=new i.Vector3,h=new i.Quaternion,d=new i.Vector3;a.placeObjectAtHit=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!t||!t.modelMatrix)throw new Error("placeObjectAtHit requires a VRHit object");c.fromArray(t.modelMatrix),c.decompose(f,h,d),1===n?(e.position.copy(f),i&&e.quaternion.copy(h)):(e.position.lerp(f,n),i&&e.quaternion.slerp(h,n))};t.placeObjectAtHit=a.placeObjectAtHit;a.getRandomPaletteColor=function(){return o[Math.floor(Math.random()*o.length)]};t.getRandomPaletteColor=a.getRandomPaletteColor;a.displayUnsupportedMessage=function(e){var t=document.createElement("div");t.id="webgl-error-message",t.style.fontFamily="monospace",t.style.fontSize="13px",t.style.fontWeight="normal",t.style.textAlign="center",t.style.background="#fff",t.style.border="1px solid black",t.style.color="#000",t.style.padding="1.5em",t.style.width="400px",t.style.margin="5em auto 0",t.innerHTML="string"==typeof e?e:'This augmented reality experience requires\n  WebARonARCore or WebARonARKit, experimental browsers from Google\n  for Android and iOS. Learn more at the <a href="https://developers.google.com/ar/develop/web/getting-started">Google Developers site</a>.',document.body.appendChild(t)};t.displayUnsupportedMessage=a.displayUnsupportedMessage;t.default=a}).call(t,n(2))},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";(function(e){function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.ARView=t.ARUtils=t.ARReticle=t.ARPerspectiveCamera=t.ARDebug=void 0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=i(n(4)),a=i(n(9)),s=i(n(10)),l=i(n(1)),u=i(n(11));n(15),"object"===r(e.THREE)&&(e.THREE.ARDebug=o.default,e.THREE.ARPerspectiveCamera=a.default,e.THREE.ARReticle=s.default,e.THREE.ARUtils=l.default,e.THREE.ARView=u.default),t.ARDebug=o.default,t.ARPerspectiveCamera=a.default,t.ARReticle=s.default,t.ARUtils=l.default,t.ARView=u.default}).call(t,n(2))},function(e,t,n){"use strict";function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t,n){var i=void 0,r=void 0;return function(){for(var o=arguments.length,a=Array(o),s=0;s<o;s++)a[s]=arguments[s];var l=+new Date,u=void 0;i&&(u=i+t-l),void 0==u||u<0?(i=l,e.apply(n,a)):u>=0&&(clearTimeout(r),r=setTimeout(function(){i=l,e.apply(n,a)},u))}}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=function(e){return e&&e.__esModule?e:{default:e}}(n(5)),c={open:!0,showLastHit:!0,showPoseStatus:!0,showPlanes:!1},f=new Map,h=function(){function e(t,n,i){o(this,e),void 0===i&&n&&"Scene"!==n.type&&(i=n,n=null),this.config=Object.assign({},c,i),this.vrDisplay=t,this._view=new d({open:this.config.open}),this.config.showLastHit&&this.vrDisplay.hitTest&&this._view.addRow("hit-test",new v(t)),this.config.showPoseStatus&&this.vrDisplay.getFrameData&&this._view.addRow("pose-status",new y(t)),this.config.showPlanes&&this.vrDisplay.getPlanes&&(n?this._view.addRow("show-planes",new m(t,n)):console.warn("ARDebug `{ showPlanes: true }` option requires passing in a THREE.Scene as the second parameter in the constructor."))}return l(e,[{key:"open",value:function(){this._view.open()}},{key:"close",value:function(){this._view.close()}},{key:"getElement",value:function(){return this._view.getElement()}}]),e}(),d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e),this.rows=new Map,this.el=document.createElement("div"),this.el.style.backgroundColor="#333",this.el.style.padding="5px",this.el.style.fontFamily="Roboto, Ubuntu, Arial, sans-serif",this.el.style.color="rgb(165, 165, 165)",this.el.style.position="absolute",this.el.style.right="20px",this.el.style.top="0px",this.el.style.width="200px",this.el.style.fontSize="12px",this.el.style.zIndex=9999,this._rowsEl=document.createElement("div"),this._rowsEl.style.transitionProperty="max-height",this._rowsEl.style.transitionDuration="0.5s",this._rowsEl.style.transitionDelay="0s",this._rowsEl.style.transitionTimingFunction="ease-out",this._rowsEl.style.overflow="hidden",this._controls=document.createElement("div"),this._controls.style.fontSize="13px",this._controls.style.fontWeight="bold",this._controls.style.paddingTop="5px",this._controls.style.textAlign="center",this._controls.style.cursor="pointer",this._controls.addEventListener("click",this.toggleControls.bind(this)),t.open?this.open():this.close(),this.el.appendChild(this._rowsEl),this.el.appendChild(this._controls)}return l(e,[{key:"toggleControls",value:function(){this._isOpen?this.close():this.open()}},{key:"open",value:function(){this._rowsEl.style.maxHeight="100px",this._isOpen=!0,this._controls.textContent="Close ARDebug";var e=!0,t=!1,n=void 0;try{for(var i,r=this.rows[Symbol.iterator]();!(e=(i=r.next()).done);e=!0){var o=i.value;s(o,2)[1].enable()}}catch(e){t=!0,n=e}finally{try{!e&&r.return&&r.return()}finally{if(t)throw n}}}},{key:"close",value:function(){this._rowsEl.style.maxHeight="0px",this._isOpen=!1,this._controls.textContent="Open ARDebug";var e=!0,t=!1,n=void 0;try{for(var i,r=this.rows[Symbol.iterator]();!(e=(i=r.next()).done);e=!0){var o=i.value;s(o,2)[1].disable()}}catch(e){t=!0,n=e}finally{try{!e&&r.return&&r.return()}finally{if(t)throw n}}}},{key:"getElement",value:function(){return this.el}},{key:"addRow",value:function(e,t){this.rows.set(e,t),this._isOpen&&t.enable(),this._rowsEl.appendChild(t.getElement())}}]),e}(),p=function(){function e(t){o(this,e),this.el=document.createElement("div"),this.el.style.width="100%",this.el.style.borderTop="1px solid rgb(54, 54, 54)",this.el.style.borderBottom="1px solid #14171A",this.el.style.position="relative",this.el.style.padding="3px 0px",this.el.style.overflow="hidden",this._titleEl=document.createElement("span"),this._titleEl.style.fontWeight="bold",this._titleEl.textContent=t,this._dataEl=document.createElement("span"),this._dataEl.style.position="absolute",this._dataEl.style.left="40px",this._dataElText=document.createTextNode(""),this._dataEl.appendChild(this._dataElText),this.el.appendChild(this._titleEl),this.el.appendChild(this._dataEl),this.update=a(this.update,500,this)}return l(e,[{key:"enable",value:function(){throw new Error("Implement in child class")}},{key:"disable",value:function(){throw new Error("Implement in child class")}},{key:"getElement",value:function(){return this.el}},{key:"update",value:function(e,t){this._dataElText.nodeValue=e,this._dataEl.style.color=t?"#00ff00":"#ff0077"}}]),e}(),v=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Hit"));return n.vrDisplay=e,n._onHitTest=n._onHitTest.bind(n),n._nativeHitTest=f.get("hitTest")||n.vrDisplay.hitTest,f.set("hitTest",n._nativeHitTest),n._didPreviouslyHit=null,n}return r(t,p),l(t,[{key:"enable",value:function(){this.vrDisplay.hitTest=this._onHitTest}},{key:"disable",value:function(){this.vrDisplay.hitTest=this._nativeHitTest}},{key:"_hitToString",value:function(e){var t=e.modelMatrix;return t[12].toFixed(2)+", "+t[13].toFixed(2)+", "+t[14].toFixed(2)}},{key:"_onHitTest",value:function(e,t){var n=this._nativeHitTest.call(this.vrDisplay,e,t),i=(parseInt(performance.now(),10)/1e3).toFixed(1),r=n&&n.length;return this.update((r?this._hitToString(n[0]):"MISS")+" @ "+i+"s",r),this._didPreviouslyHit=r,n}}]),t}(),y=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Pose"));return n.vrDisplay=e,n._onGetFrameData=n._onGetFrameData.bind(n),n._nativeGetFrameData=f.get("getFrameData")||n.vrDisplay.getFrameData,f.set("getFrameData",n._nativeGetFrameData),n.update("Looking for position..."),n._initialPose=!1,n}return r(t,p),l(t,[{key:"enable",value:function(){this.vrDisplay.getFrameData=this._onGetFrameData}},{key:"disable",value:function(){this.vrDisplay.getFrameData=this._nativeGetFrameData}},{key:"_poseToString",value:function(e){return e[0].toFixed(2)+", "+e[1].toFixed(2)+", "+e[2].toFixed(2)}},{key:"_onGetFrameData",value:function(e){var t=this._nativeGetFrameData.call(this.vrDisplay,e),n=e&&e.pose&&e.pose.position,i=n&&"number"==typeof n[0]&&"number"==typeof n[1]&&"number"==typeof n[2]&&!(0===n[0]&&0===n[1]&&0===n[2]);return this._initialPose||i?(i?this.update(this._poseToString(n),!0):i||!1===this._lastPoseValid||this.update("Position lost",!1),this._lastPoseValid=i,this._initialPose=!0,t):t}}]),t}(),m=function(e){function t(e,n){o(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Planes"));return r.vrDisplay=e,r.planes=new u.default(r.vrDisplay),r._onPoll=r._onPoll.bind(r),r.update("Looking for planes..."),n&&n.add(r.planes),r}return r(t,p),l(t,[{key:"enable",value:function(){this._timer&&this.disable(),this._timer=setInterval(this._onPoll,500),this.planes.enable()}},{key:"disable",value:function(){clearInterval(this._timer),this._timer=null,this.planes.disable()}},{key:"_planesToString",value:function(e){return e+" plane"+(1===e?"":"s")+" found"}},{key:"_onPoll",value:function(){var e=this.planes.size();this.update(this._planesToString(e),e>0)}}]),t}();t.default=h},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(0),u=n(1),c=i(n(7)),f=i(n(8)),h=new l.RawShaderMaterial({side:l.DoubleSide,transparent:!0,uniforms:{dotColor:{value:new l.Color(16777215)},lineColor:{value:new l.Color(7368816)},backgroundColor:{value:new l.Color(4210752)},dotRadius:{value:.006666666667},alpha:{value:.4}},vertexShader:c.default,fragmentShader:f.default}),d=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.addPlane_=function(e){var t=n.createPlane(e);t&&(n.add(t),n.planes.set(e.identifier,t))},n.removePlane_=function(e){var t=n.planes.get(e);t&&n.remove(t),n.planes.delete(e)},n.onPlaneAdded_=function(e){e.planes.forEach(function(e){return n.addPlane_(e)})},n.onPlaneUpdated_=function(e){var t=!0,i=!1,r=void 0;try{for(var o,a=e.planes[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var s=o.value;n.removePlane_(s.identifier),n.addPlane_(s)}}catch(e){i=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(i)throw r}}},n.onPlaneRemoved_=function(e){var t=!0,i=!1,r=void 0;try{for(var o,a=e.planes[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var s=o.value;n.removePlane_(s.identifier)}}catch(e){i=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(i)throw r}}},n.vrDisplay=e,n.planes=new Map,n.materials=new Map,n}return a(t,l.Object3D),s(t,[{key:"enable",value:function(){this.vrDisplay.getPlanes().forEach(this.addPlane_),this.vrDisplay.addEventListener("planesadded",this.onPlaneAdded_),this.vrDisplay.addEventListener("planesupdated",this.onPlaneUpdated_),this.vrDisplay.addEventListener("planesremoved",this.onPlaneRemoved_)}},{key:"disable",value:function(){this.vrDisplay.removeEventListener("planesadded",this.onPlaneAdded_),this.vrDisplay.removeEventListener("planesupdated",this.onPlaneUpdated_),this.vrDisplay.removeEventListener("planesremoved",this.onPlaneRemoved_);var e=!0,t=!1,n=void 0;try{for(var i,r=this.planes.keys()[Symbol.iterator]();!(e=(i=r.next()).done);e=!0){var o=i.value;this.removePlane_(o)}}catch(e){t=!0,n=e}finally{try{!e&&r.return&&r.return()}finally{if(t)throw n}}this.materials.clear()}},{key:"createPlane",value:function(e){if(0==e.vertices.length)return null;for(var t=new l.Geometry,n=0;n<e.vertices.length/3;n++)t.vertices.push(new l.Vector3(e.vertices[3*n],e.vertices[3*n+1],e.vertices[3*n+2]));for(var i=0;i<t.vertices.length-2;i++)t.faces.push(new l.Face3(0,i+1,i+2));var r=void 0;if(this.materials.has(e.identifier))r=this.materials.get(e.identifier);else{var o=(0,u.getRandomPaletteColor)();(r=h.clone()).uniforms.backgroundColor.value=o,this.materials.set(e.identifier,r)}var a=new l.Mesh(t,r),s=e.modelMatrix;return a.matrixAutoUpdate=!1,a.matrix.set(s[0],s[4],s[8],s[12],s[1],s[5],s[9],s[13],s[2],s[6],s[10],s[14],s[3],s[7],s[11],s[15]),this.add(a),a}},{key:"size",value:function(){return this.planes.size}}]),t}();t.default=d},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){},i=function(e){0===e.opacity&&(e.opacity=1)};t.loadObj=function(t,r){return new Promise(function(o,a){var s=new e.THREE.OBJLoader;r&&(Object.keys(r.materials).forEach(function(e){return i(r.materials[e])}),s.setMaterials(r)),s.load(t,o,n,a)})},t.loadMtl=function(t){return new Promise(function(i,r){var o=new e.THREE.MTLLoader;o.setTexturePath(t.substring(0,t.lastIndexOf("/")+1)),o.setMaterialOptions({ignoreZeroRGBs:!0}),o.load(t,i,n,r)})}}).call(t,n(2))},function(e,t,n){"use strict";e.exports="// Copyright 2017 Google Inc. All Rights Reserved.\n// Licensed under the Apache License, Version 2.0 (the 'License');\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an 'AS IS' BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nprecision mediump float;\nprecision mediump int;\n#define GLSLIFY 1\n\nuniform mat4 modelViewMatrix;\nuniform mat4 modelMatrix;\nuniform mat4 projectionMatrix;\n\nattribute vec3 position;\n\nvarying vec3 vPosition;\n\nvoid main() {\n  vPosition = (modelMatrix * vec4(position, 1.0)).xyz;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n"},function(e,t,n){"use strict";e.exports="// Copyright 2017 Google Inc. All Rights Reserved.\n// Licensed under the Apache License, Version 2.0 (the 'License');\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an 'AS IS' BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nprecision highp float;\n#define GLSLIFY 1\n\nvarying vec3 vPosition;\n\n#define countX 7.0\n#define countY 4.0\n#define gridAlpha 0.75\n\nuniform float dotRadius; //ui:0.0,0.01,0.006666666667\nuniform vec3 dotColor; //ui:0.0,1.0,1.0\nuniform vec3 lineColor; //ui:0.0,1.0,0.50\nuniform vec3 backgroundColor; //ui:0.0,1.0,0.25\nuniform float alpha; //ui:0.0,1.0,1.0\n\nfloat Circle( in vec2 p, float r ) {\n  return length( p ) - r;\n}\n\nfloat Line( in vec2 p, in vec2 a, in vec2 b ) {\n  vec2 pa = p - a;\n  vec2 ba = b - a;\n  float t = clamp( dot( pa, ba ) / dot( ba, ba ), 0.0, 1.0);\n  vec2 pt = a + t * ba;\n  return length( pt - p );\n}\n\nfloat Union( float a, float b ) {\n  return min( a, b );\n}\n\nvoid main()\n{\n  vec2 count = vec2( countX, countY );\n  vec2 size = vec2( 1.0 ) / count;\n  vec2 halfSize = size * 0.5;\n  vec2 uv = mod( vPosition.xz * 1.5, size ) - halfSize;\n\n  float dots = Circle( uv - vec2( halfSize.x, 0.0 ), dotRadius );\n  dots = Union( dots, Circle( uv + vec2( halfSize.x, 0.0 ), dotRadius ) );\n  dots = Union( dots, Circle( uv + vec2( 0.0, halfSize.y ), dotRadius ) );\n  dots = Union( dots, Circle( uv - vec2( 0.0, halfSize.y ), dotRadius ) );\n\n  float lines = Line( uv, vec2( 0.0, halfSize.y ), -vec2( halfSize.x, 0.0 ) );\n  lines = Union( lines, Line( uv, vec2( 0.0, -halfSize.y ), -vec2( halfSize.x, 0.0 ) ) );\n  lines = Union( lines, Line( uv, vec2( 0.0, -halfSize.y ), vec2( halfSize.x, 0.0 ) ) );\n  lines = Union( lines, Line( uv, vec2( 0.0, halfSize.y ), vec2( halfSize.x, 0.0 ) ) );\n  lines = Union( lines, Line( uv, vec2( -halfSize.x, halfSize.y ), vec2( halfSize.x, halfSize.y ) ) );\n  lines = Union( lines, Line( uv, vec2( -halfSize.x, -halfSize.y ), vec2( halfSize.x, -halfSize.y ) ) );\n  lines = Union( lines, Line( uv, vec2( -halfSize.x, 0.0 ), vec2( halfSize.x, 0.0 ) ) );\n\n  lines = clamp( smoothstep( 0.0, 0.0035, lines ), 0.0, 1.0 );\n  dots = clamp( smoothstep( 0.0, 0.001, dots ), 0.0, 1.0 );\n\n  float result = Union( dots, lines );\n  gl_FragColor = vec4( mix( backgroundColor + mix( dotColor, lineColor, dots ),\n    backgroundColor, result ), mix( gridAlpha, alpha, result ) );\n}\n"},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},l=n(0),u=void 0,c=function(e){function t(e,n,o,a,s){i(this,t);var l=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n,o,a,s));return l.isARPerpsectiveCamera=!0,l.vrDisplay=e,l.updateProjectionMatrix(),e&&e.capabilities.hasPassThroughCamera||console.warn("ARPerspectiveCamera does not a VRDisplay with\n                    a pass through camera. Using supplied values and defaults\n                    instead of device camera intrinsics"),l}return o(t,l.PerspectiveCamera),a(t,[{key:"updateProjectionMatrix",value:function(){var e=this.getProjectionMatrix();e?this.projectionMatrix.fromArray(e):s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateProjectionMatrix",this).call(this)}},{key:"getProjectionMatrix",value:function(){return this.vrDisplay&&this.vrDisplay.getFrameData?(u||(u=new VRFrameData),this.vrDisplay.getFrameData(u),u.leftProjectionMatrix):null}}]),t}();t.default=c},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(0),l=n(1),u=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.02,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.05,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16711799,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.25;i(this,t);var u=new s.RingGeometry(n,o,36,64),c=new s.MeshBasicMaterial({color:a});u.applyMatrix((new s.Matrix4).makeRotationX(s.Math.degToRad(-90)));var f=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,u,c));return f.visible=!1,f.easing=l,f.applyOrientation=!0,f.vrDisplay=e,f._planeDir=new s.Vector3,f}return o(t,s.Mesh),a(t,[{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;if(this.vrDisplay&&this.vrDisplay.hitTest){var n=this.vrDisplay.hitTest(e,t);n&&n.length>0&&(this.visible=!0,(0,l.placeObjectAtHit)(this,n[0],this.applyOrientation,this.easing))}}}]),t}();t.default=u},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t,n){var i=void 0;if("fragment"==n)i=e.createShader(e.FRAGMENT_SHADER);else{if("vertex"!=n)return null;i=e.createShader(e.VERTEX_SHADER)}return e.shaderSource(i,t),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS)?i:(alert(e.getShaderInfoLog(i)),null)}function a(e,t,n){var i=o(e,t,"vertex"),r=o(e,n,"fragment");if(!r)return null;var a=e.createProgram();return e.attachShader(a,i),e.attachShader(a,r),e.linkProgram(a),e.getProgramParameter(a,e.LINK_STATUS)||alert("Could not initialise arview shaders"),a}function s(e,t){var n=0;switch(t){case 90:n=1;break;case 180:n=2;break;case 270:n=3;break;default:n=0}var i=0;switch(e){case 90:i=1;break;case 180:i=2;break;case 270:i=3;break;default:i=0}var r=i-n;return r<0&&(r+=4),r%4}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(1),c=i(n(12)),f=i(n(13)),h=i(n(14)),d=function(){function e(t,n){r(this,e),this.vrDisplay=t,this.gl=n,this.vrDisplay&&(this.passThroughCamera=t.getPassThroughCamera(),this.program=a(n,c.default,f.default)),n.useProgram(this.program),this.vertexPositionAttribute=n.getAttribLocation(this.program,"aVertexPosition"),this.textureCoordAttribute=n.getAttribLocation(this.program,"aTextureCoord"),this.samplerUniform=n.getUniformLocation(this.program,"uSampler"),this.vertexPositionBuffer=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this.vertexPositionBuffer);var i=[-1,1,0,-1,-1,0,1,1,0,1,-1,0],o=new Float32Array(i);n.bufferData(n.ARRAY_BUFFER,o,n.STATIC_DRAW),this.vertexPositionBuffer.itemSize=3,this.vertexPositionBuffer.numItems=12,this.textureCoordBuffer=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this.textureCoordBuffer);var l=null;if(this.vrDisplay){var u=this.passThroughCamera.width/this.passThroughCamera.textureWidth,h=this.passThroughCamera.height/this.passThroughCamera.textureHeight;l=[[0,0,0,h,u,0,u,h],[u,0,0,0,u,h,0,h],[u,h,u,0,0,h,0,0],[0,h,u,h,0,0,u,0]]}else l=[[0,0,0,1,1,0,1,1],[1,0,0,0,1,1,0,1],[1,1,1,0,0,1,0,0],[0,1,1,1,0,0,1,0]];this.f32TextureCoords=[];for(var d=0;d<l.length;d++)this.f32TextureCoords.push(new Float32Array(l[d]));this.combinedOrientation=s(screen.orientation.angle,this.passThroughCamera.orientation),n.bufferData(n.ARRAY_BUFFER,this.f32TextureCoords[this.combinedOrientation],n.STATIC_DRAW),this.textureCoordBuffer.itemSize=2,this.textureCoordBuffer.numItems=8,n.bindBuffer(n.ARRAY_BUFFER,null),this.indexBuffer=n.createBuffer(),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var p=[0,1,2,2,1,3],v=new Uint16Array(p);return n.bufferData(n.ELEMENT_ARRAY_BUFFER,v,n.STATIC_DRAW),this.indexBuffer.itemSize=1,this.indexBuffer.numItems=6,n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null),this.texture=n.createTexture(),n.useProgram(null),this.projectionMatrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.mvMatrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this}return l(e,[{key:"render",value:function(){var e=this,t=this.gl,n=[t.ARRAY_BUFFER_BINDING,t.ELEMENT_ARRAY_BUFFER_BINDING,t.CURRENT_PROGRAM];(0,h.default)(t,n,function(){t.useProgram(e.program),t.bindBuffer(t.ARRAY_BUFFER,e.vertexPositionBuffer),t.enableVertexAttribArray(e.vertexPositionAttribute),t.vertexAttribPointer(e.vertexPositionAttribute,e.vertexPositionBuffer.itemSize,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,e.textureCoordBuffer);var n=s(screen.orientation.angle,e.passThroughCamera.orientation);n!==e.combinedOrientation&&(e.combinedOrientation=n,t.bufferData(t.ARRAY_BUFFER,e.f32TextureCoords[e.combinedOrientation],t.STATIC_DRAW)),t.enableVertexAttribArray(e.textureCoordAttribute),t.vertexAttribPointer(e.textureCoordAttribute,e.textureCoordBuffer.itemSize,t.FLOAT,!1,0,0),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_EXTERNAL_OES,e.texture),t.texImage2D(t.TEXTURE_EXTERNAL_OES,0,t.RGB,t.RGB,t.UNSIGNED_BYTE,e.passThroughCamera),t.uniform1i(e.samplerUniform,0),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e.indexBuffer),t.drawElements(t.TRIANGLES,e.indexBuffer.numItems,t.UNSIGNED_SHORT,0)})}}]),e}(),p=function(){function e(t,n){r(this,e),this.vrDisplay=t,(0,u.isARKit)(this.vrDisplay)||(this.renderer=n,this.gl=n.context,this.videoRenderer=new d(t,this.gl),this.width=window.innerWidth,this.height=window.innerHeight,window.addEventListener("resize",this.onWindowResize.bind(this),!1))}return l(e,[{key:"onWindowResize",value:function(){this.width=window.innerWidth,this.height=window.innerHeight}},{key:"render",value:function(){if(!(0,u.isARKit)(this.vrDisplay)){var e=this.gl,t=window.devicePixelRatio,n=this.width*t,i=this.height*t;e.viewportWidth!==n&&(e.viewportWidth=n),e.viewportHeight!==i&&(e.viewportHeight=i),this.gl.viewport(0,0,e.viewportWidth,e.viewportHeight),this.videoRenderer.render()}}}]),e}();t.default=p},function(e,t,n){"use strict";e.exports="#define GLSLIFY 1\n// Copyright 2017 Google Inc. All Rights Reserved.\n// Licensed under the Apache License, Version 2.0 (the 'License');\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an 'AS IS' BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nattribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void) {\n  gl_Position = vec4(aVertexPosition, 1.0);\n  vTextureCoord = aTextureCoord;\n}\n"},function(e,t,n){"use strict";e.exports="// Copyright 2017 Google Inc. All Rights Reserved.\n// Licensed under the Apache License, Version 2.0 (the 'License');\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an 'AS IS' BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n#extension GL_OES_EGL_image_external : require\n\nprecision mediump float;\n#define GLSLIFY 1\n\nvarying vec2 vTextureCoord;\n\nuniform samplerExternalOES uSampler;\n\nvoid main(void) {\n  gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},function(e,t){e.exports=function(e,t,n){if(t){for(var i=[],r=null,o=0;o<t.length;++o)switch(a=t[o]){case e.TEXTURE_BINDING_2D:case e.TEXTURE_BINDING_CUBE_MAP:if((l=t[++o])<e.TEXTURE0||l>e.TEXTURE31){console.error("TEXTURE_BINDING_2D or TEXTURE_BINDING_CUBE_MAP must be followed by a valid texture unit"),i.push(null,null);break}r||(r=e.getParameter(e.ACTIVE_TEXTURE)),e.activeTexture(l),i.push(e.getParameter(a),null);break;case e.ACTIVE_TEXTURE:r=e.getParameter(e.ACTIVE_TEXTURE),i.push(null);break;default:i.push(e.getParameter(a))}for(n(e),o=0;o<t.length;++o){var a=t[o],s=i[o];switch(a){case e.ACTIVE_TEXTURE:break;case e.ARRAY_BUFFER_BINDING:e.bindBuffer(e.ARRAY_BUFFER,s);break;case e.COLOR_CLEAR_VALUE:e.clearColor(s[0],s[1],s[2],s[3]);break;case e.COLOR_WRITEMASK:e.colorMask(s[0],s[1],s[2],s[3]);break;case e.CURRENT_PROGRAM:e.useProgram(s);break;case e.ELEMENT_ARRAY_BUFFER_BINDING:e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,s);break;case e.FRAMEBUFFER_BINDING:e.bindFramebuffer(e.FRAMEBUFFER,s);break;case e.RENDERBUFFER_BINDING:e.bindRenderbuffer(e.RENDERBUFFER,s);break;case e.TEXTURE_BINDING_2D:if((l=t[++o])<e.TEXTURE0||l>e.TEXTURE31)break;e.activeTexture(l),e.bindTexture(e.TEXTURE_2D,s);break;case e.TEXTURE_BINDING_CUBE_MAP:var l=t[++o];if(l<e.TEXTURE0||l>e.TEXTURE31)break;e.activeTexture(l),e.bindTexture(e.TEXTURE_CUBE_MAP,s);break;case e.VIEWPORT:e.viewport(s[0],s[1],s[2],s[3]);break;case e.BLEND:case e.CULL_FACE:case e.DEPTH_TEST:case e.SCISSOR_TEST:case e.STENCIL_TEST:s?e.enable(a):e.disable(a);break;default:console.log("No GL restore behavior for 0x"+a.toString(16))}r&&e.activeTexture(r)}}else n(e)}},function(e,t,n){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){if(window.webarSpeechRecognitionInstance){(function(e){e.listeners={},e.addEventListener=function(e,t){if(!t)return this;var n=this.listeners[e];return n||(this.listeners[e]=n=[]),n.indexOf(t)<0&&n.push(t),this},e.removeEventListener=function(e,t){if(!t)return this;var n=this.listeners[e];if(n){var i=n.indexOf(t);i>=0&&(this.listeners[e]=n.splice(i,1))}return this},e.callEventListeners=function(e,t){t||(t={target:this}),t.target||(t.target=this),t.type=e;var n="on"+e;"function"==typeof this[n]&&this[n](t);var r=this.listeners[e];if(r)for(var o=0;o<r.length;o++){var a=i(r[o]);"object"===a?r[o].handleEvent(t):"function"===a&&r[o](t)}return this}})(window.webarSpeechRecognitionInstance);window.webkitSpeechRecognition;window.webkitSpeechRecognition=function(){return window.webarSpeechRecognitionInstance}}}()}])});